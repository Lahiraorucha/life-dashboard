<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaiti's Life Dashboard v3</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 100%);
            min-height: 100vh;
            color: #fff;
            padding-bottom: 70px;
        }

        .nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            padding: 15px 20px;
            background: rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .nav-btn {
            padding: 10px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s;
            background: rgba(255,255,255,0.1);
            color: #fff;
        }
        .nav-btn.active {
            background: linear-gradient(90deg, #feca57, #ff6b6b);
            color: #1a1a2e;
            font-weight: bold;
        }
        .add-task-btn {
            padding: 10px 20px;
            border: 2px dashed rgba(255,255,255,0.3);
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            background: transparent;
            color: #feca57;
            margin-left: 20px;
            transition: all 0.3s;
        }
        .add-task-btn:hover {
            background: rgba(254,202,87,0.1);
            border-color: #feca57;
        }

        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

        .header { text-align: center; margin-bottom: 20px; }
        .header h1 {
            font-size: 2rem;
            background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header-sub { color: #888; font-size: 0.9rem; margin-top: 5px; }

        .countdowns {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        @media (max-width: 800px) { .countdowns { grid-template-columns: repeat(2, 1fr); } }
        .countdown-card {
            background: rgba(255,255,255,0.06);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            border-left: 3px solid;
        }
        .countdown-card.marathon { border-color: #ff6b6b; }
        .countdown-card.gallery { border-color: #48dbfb; }
        .countdown-card.job { border-color: #feca57; }
        .countdown-card.streak { border-color: #10b981; }
        .countdown-number { font-size: 1.8rem; font-weight: bold; }
        .countdown-label { font-size: 0.75rem; color: #888; }

        .view { display: none; }
        .view.active { display: block; }

        .today-grid {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
        }
        @media (max-width: 900px) { .today-grid { grid-template-columns: 1fr; } }

        .card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 16px;
            border: 1px solid rgba(255,255,255,0.08);
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        .card-header h2 { font-size: 1rem; color: #ddd; }
        .card-header-btn {
            padding: 5px 12px;
            background: rgba(254,202,87,0.2);
            border: none;
            border-radius: 15px;
            color: #feca57;
            font-size: 0.8rem;
            cursor: pointer;
        }

        .task-list { min-height: 200px; }
        .task-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 10px;
            background: rgba(255,255,255,0.04);
            cursor: grab;
            transition: all 0.2s;
            border-left: 3px solid transparent;
            position: relative;
        }
        .task-item:hover { background: rgba(255,255,255,0.08); }
        .task-item.dragging { opacity: 0.5; transform: scale(1.02); }
        .task-item.completed { opacity: 0.4; }

        .task-item.cat-gym { border-color: #ff6b6b; }
        .task-item.cat-paint { border-color: #48dbfb; }
        .task-item.cat-job { border-color: #feca57; }
        .task-item.cat-app { border-color: #10b981; }
        .task-item.cat-other { border-color: #a855f7; }

        .task-checkbox {
            width: 22px; height: 22px;
            border-radius: 6px;
            border: 2px solid #444;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            cursor: pointer;
            transition: all 0.2s;
        }
        .task-item.completed .task-checkbox { background: #10b981; border-color: #10b981; }
        .task-checkbox-inner { color: white; opacity: 0; font-size: 14px; }
        .task-item.completed .task-checkbox-inner { opacity: 1; }

        .task-content { flex: 1; min-width: 0; }
        .task-title { font-weight: 500; font-size: 0.95rem; }
        .task-meta { font-size: 0.75rem; color: #888; margin-top: 2px; }

        .task-actions {
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        .task-item:hover .task-actions { opacity: 1; }
        .task-action-btn {
            width: 28px; height: 28px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .task-action-btn.edit { background: rgba(72,219,251,0.2); color: #48dbfb; }
        .task-action-btn.delete { background: rgba(239,68,68,0.2); color: #ef4444; }

        .drop-zone {
            min-height: 60px;
            border: 2px dashed rgba(255,255,255,0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 0.85rem;
            margin-top: 10px;
        }

        .week-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }
        @media (max-width: 1000px) { .week-grid { grid-template-columns: repeat(3, 1fr); } }
        @media (max-width: 600px) { .week-grid { grid-template-columns: 1fr 1fr; } }

        .day-column {
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            padding: 10px;
            min-height: 350px;
        }
        .day-column.today { border: 1px solid rgba(254,202,87,0.5); }
        .day-header {
            text-align: center;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 8px;
        }
        .day-name { font-weight: bold; font-size: 0.85rem; }
        .day-date { font-size: 0.7rem; color: #888; }

        .week-task {
            padding: 8px;
            margin-bottom: 6px;
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            border-left: 2px solid;
        }
        .week-task.completed { opacity: 0.4; text-decoration: line-through; }
        .week-task.cat-gym { background: rgba(255,107,107,0.15); border-color: #ff6b6b; }
        .week-task.cat-paint { background: rgba(72,219,251,0.15); border-color: #48dbfb; }
        .week-task.cat-job { background: rgba(254,202,87,0.15); border-color: #feca57; }
        .week-task.cat-app { background: rgba(16,185,129,0.15); border-color: #10b981; }
        .week-task.cat-other { background: rgba(168,85,247,0.15); border-color: #a855f7; }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .modal-overlay.active { display: flex; }
        .modal {
            background: #1a1a2e;
            border-radius: 16px;
            padding: 25px;
            width: 90%;
            max-width: 450px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .modal h3 { margin-bottom: 20px; font-size: 1.2rem; }
        .form-group { margin-bottom: 15px; }
        .form-group label {
            display: block;
            font-size: 0.85rem;
            color: #888;
            margin-bottom: 6px;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px 12px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.05);
            color: #fff;
            font-size: 0.95rem;
        }
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .modal-btn {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
        }
        .modal-btn.primary {
            background: linear-gradient(90deg, #feca57, #ff6b6b);
            color: #1a1a2e;
        }
        .modal-btn.secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }
        .modal-btn.danger {
            background: rgba(239,68,68,0.2);
            color: #ef4444;
        }

        .sidebar-card { margin-bottom: 15px; }
        .sidebar-card h3 {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 10px;
        }
        .stats-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        .stat-box {
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }
        .stat-value { font-size: 1.5rem; font-weight: bold; }
        .stat-label { font-size: 0.7rem; color: #888; }

        .mini-suggestion {
            padding: 8px 10px;
            background: rgba(255,255,255,0.03);
            border-radius: 6px;
            margin-bottom: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 2px solid #666;
        }
        .mini-suggestion:hover { background: rgba(255,255,255,0.08); }
        .mini-suggestion.cat-gym { border-color: #ff6b6b; }
        .mini-suggestion.cat-paint { border-color: #48dbfb; }
        .mini-suggestion.cat-job { border-color: #feca57; }
        .mini-suggestion.cat-app { border-color: #10b981; }

        .goal-progress {
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            overflow: hidden;
            margin: 10px 0;
        }
        .goal-progress-fill {
            height: 100%;
            border-radius: 8px;
        }
        .goal-progress-fill.paint { background: linear-gradient(90deg, #48dbfb, #0abde3); }

        .footer {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            background: rgba(15,15,26,0.95);
            padding: 12px;
            display: flex;
            justify-content: center;
            gap: 10px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        .footer-btn {
            padding: 10px 20px;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            font-size: 0.85rem;
        }
        .footer-btn.primary {
            background: linear-gradient(90deg, #feca57, #ff6b6b);
            color: #1a1a2e;
            font-weight: bold;
        }
        .footer-btn.secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }

        .goals-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        @media (max-width: 800px) { .goals-grid { grid-template-columns: 1fr; } }
        .goal-card { padding: 20px; }
        .goal-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        .goal-title { font-weight: bold; }
        .goal-deadline { font-size: 0.8rem; color: #888; }
    </style>
</head>
<body>
    <nav class="nav">
        <button class="nav-btn active" id="btnToday">üìÖ Today</button>
        <button class="nav-btn" id="btnWeek">üìä Week</button>
        <button class="nav-btn" id="btnGoals">üéØ Goals</button>
        <button class="add-task-btn" id="btnAddTask">+ Add Task</button>
    </nav>

    <div class="container">
        <div class="header">
            <h1>Life Dashboard</h1>
            <div class="header-sub" id="headerSub">Loading...</div>
        </div>

        <div class="countdowns">
            <div class="countdown-card marathon">
                <div class="countdown-number" id="marathonDays">--</div>
                <div class="countdown-label">Days to Marathon</div>
            </div>
            <div class="countdown-card gallery">
                <div class="countdown-number" id="galleryDays">--</div>
                <div class="countdown-label">Days to Gallery</div>
            </div>
            <div class="countdown-card job">
                <div class="countdown-number">6</div>
                <div class="countdown-label">Active Apps</div>
            </div>
            <div class="countdown-card streak">
                <div class="countdown-number" id="streakDays">0</div>
                <div class="countdown-label">Day Streak üî•</div>
            </div>
        </div>

        <!-- TODAY VIEW -->
        <div class="view active" id="todayView">
            <div class="today-grid">
                <div class="card">
                    <div class="card-header">
                        <h2>üìã Today's Tasks</h2>
                        <button class="card-header-btn" id="btnFromTemplate">+ From Template</button>
                    </div>
                    <div class="task-list" id="todayTasks"></div>
                    <div class="drop-zone">Drop task here or click "+ Add Task"</div>
                </div>

                <div>
                    <div class="card sidebar-card">
                        <div class="stats-row">
                            <div class="stat-box">
                                <div class="stat-value" id="completedCount">0</div>
                                <div class="stat-label">Completed</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="remainingCount">0</div>
                                <div class="stat-label">Remaining</div>
                            </div>
                        </div>
                        <div class="goal-progress">
                            <div class="goal-progress-fill paint" id="dayProgressBar" style="width: 0%"></div>
                        </div>
                    </div>

                    <div class="card sidebar-card">
                        <h3>üí° Suggested for Today</h3>
                        <div id="suggestionList"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- WEEK VIEW -->
        <div class="view" id="weekView">
            <div class="week-grid" id="weekGrid"></div>
        </div>

        <!-- GOALS VIEW -->
        <div class="view" id="goalsView">
            <div class="goals-grid">
                <div class="card goal-card">
                    <div class="goal-header">
                        <span class="goal-title">üé® Gallery Exhibit</span>
                        <span class="goal-deadline">April 24, 2026</span>
                    </div>
                    <div class="goal-progress">
                        <div class="goal-progress-fill paint" style="width: 0%"></div>
                    </div>
                    <div style="font-size: 0.85rem; color: #888;">0/5 paintings</div>
                </div>
                <div class="card goal-card">
                    <div class="goal-header">
                        <span class="goal-title">üèÉ Half Marathon</span>
                        <span class="goal-deadline">April 23, 2026</span>
                    </div>
                    <div class="goal-progress">
                        <div class="goal-progress-fill paint" style="width: 8%; background: linear-gradient(90deg, #ff6b6b, #ee5253);"></div>
                    </div>
                    <div style="font-size: 0.85rem; color: #888;">Week 1/12</div>
                </div>
                <div class="card goal-card">
                    <div class="goal-header">
                        <span class="goal-title">üíº Dream Job</span>
                        <span class="goal-deadline">Priority #1</span>
                    </div>
                    <div style="display: flex; gap: 15px; margin-top: 10px;">
                        <div><span style="font-size: 1.5rem; font-weight: bold; color: #10b981;">6</span><br><span style="font-size: 0.7rem; color: #888;">Active</span></div>
                        <div><span style="font-size: 1.5rem; font-weight: bold; color: #feca57;">3</span><br><span style="font-size: 0.7rem; color: #888;">Follow-up</span></div>
                        <div><span style="font-size: 1.5rem; font-weight: bold; color: #ef4444;">2</span><br><span style="font-size: 0.7rem; color: #888;">Rejected</span></div>
                    </div>
                </div>
                <div class="card goal-card">
                    <div class="goal-header">
                        <span class="goal-title">üì± AI Fashion App</span>
                        <span class="goal-deadline">Beta Soon</span>
                    </div>
                    <div class="goal-progress">
                        <div class="goal-progress-fill paint" style="width: 70%; background: linear-gradient(90deg, #10b981, #059669);"></div>
                    </div>
                    <div style="font-size: 0.85rem; color: #888;">~70% to beta</div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <button class="footer-btn secondary" id="btnReset">üîÑ Reset</button>
        <button class="footer-btn secondary" id="btnUndo">‚Ü©Ô∏è Undo</button>
        <button class="footer-btn primary" id="btnEndDay">‚úÖ End Day</button>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="taskModal">
        <div class="modal">
            <h3 id="modalTitle">Add New Task</h3>
            <div class="form-group">
                <label>Task Name</label>
                <input type="text" id="taskName" placeholder="What do you need to do?">
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Category</label>
                    <select id="taskCategory">
                        <option value="gym">üèÉ Gym/Training</option>
                        <option value="paint">üé® Painting</option>
                        <option value="job">üíº Job Hunt</option>
                        <option value="app">üíª App Dev</option>
                        <option value="other">üìå Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Duration</label>
                    <select id="taskDuration">
                        <option value="30 min">30 min</option>
                        <option value="1 hr" selected>1 hour</option>
                        <option value="1.5 hrs">1.5 hours</option>
                        <option value="2 hrs">2 hours</option>
                        <option value="3 hrs">3 hours</option>
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Time</label>
                    <input type="time" id="taskTime" value="09:00">
                </div>
                <div class="form-group">
                    <label>Day</label>
                    <select id="taskDay">
                        <option value="today">Today</option>
                    </select>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary" id="btnCancel">Cancel</button>
                <button class="modal-btn danger" id="btnDelete" style="display: none;">Delete</button>
                <button class="modal-btn primary" id="btnSave">Save Task</button>
            </div>
        </div>
    </div>

    <script>
        // ========== DATA ==========
        var tasks = {};
        var editingTaskId = null;
        var undoStack = [];

        var templateSchedule = {
            Mon: [
                { id: 't1', time: '08:00', title: 'Gym / Run', duration: '2 hrs', category: 'gym' },
                { id: 't2', time: '10:30', title: 'Job Hunting', duration: '1.5 hrs', category: 'job' },
                { id: 't3', time: '14:00', title: 'App Development', duration: '3 hrs', category: 'app' }
            ],
            Tue: [
                { id: 't4', time: '08:00', title: 'Gym / Cross-train', duration: '1.5 hrs', category: 'gym' },
                { id: 't5', time: '10:30', title: 'PAINTING', duration: '3 hrs', category: 'paint' },
                { id: 't6', time: '14:30', title: 'Job Hunting', duration: '1.5 hrs', category: 'job' }
            ],
            Wed: [
                { id: 't7', time: '08:00', title: 'Gym / Run', duration: '2 hrs', category: 'gym' },
                { id: 't8', time: '10:30', title: 'Job Hunting', duration: '1.5 hrs', category: 'job' },
                { id: 't9', time: '14:00', title: 'App Development', duration: '3 hrs', category: 'app' }
            ],
            Thu: [
                { id: 't10', time: '08:00', title: 'Gym / Cross-train', duration: '1.5 hrs', category: 'gym' },
                { id: 't11', time: '10:30', title: 'PAINTING', duration: '3 hrs', category: 'paint' },
                { id: 't12', time: '14:30', title: 'Job Hunting', duration: '1.5 hrs', category: 'job' }
            ],
            Fri: [
                { id: 't13', time: '08:00', title: 'Gym / Run', duration: '2 hrs', category: 'gym' },
                { id: 't14', time: '10:30', title: 'Job Hunting', duration: '1.5 hrs', category: 'job' },
                { id: 't15', time: '14:00', title: 'App Development', duration: '2 hrs', category: 'app' }
            ],
            Sat: [
                { id: 't16', time: '08:00', title: 'Long Run', duration: '2.5 hrs', category: 'gym' },
                { id: 't17', time: '11:00', title: 'PAINTING (Big Session)', duration: '4 hrs', category: 'paint' }
            ],
            Sun: [
                { id: 't18', time: '09:00', title: 'Easy Run / Rest', duration: '1 hr', category: 'gym' },
                { id: 't19', time: '11:00', title: 'PAINTING', duration: '3 hrs', category: 'paint' },
                { id: 't20', time: '15:00', title: 'Week Review', duration: '1 hr', category: 'job' }
            ]
        };

        // ========== HELPERS ==========
        function getTodayKey() {
            return new Date().toISOString().split('T')[0];
        }

        function getDayName() {
            var days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            return days[new Date().getDay()];
        }

        function formatTime(time24) {
            var parts = time24.split(':');
            var hour = parseInt(parts[0]);
            var min = parts[1];
            var ampm = hour >= 12 ? 'PM' : 'AM';
            var hour12 = hour % 12 || 12;
            return hour12 + ':' + min + ' ' + ampm;
        }

        function generateId() {
            return 'task_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function loadData() {
            try {
                var stored = localStorage.getItem('dashboardTasks');
                tasks = stored ? JSON.parse(stored) : {};
            } catch(e) {
                tasks = {};
            }
        }

        function saveData() {
            localStorage.setItem('dashboardTasks', JSON.stringify(tasks));
        }

        function saveUndo() {
            undoStack.push(JSON.stringify(tasks));
            if (undoStack.length > 20) undoStack.shift();
        }

        // ========== HEADER ==========
        function updateHeader() {
            var now = new Date();
            var days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            var timeStr = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
            var dateStr = now.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });

            var hour = now.getHours();
            var greeting = 'Good morning';
            if (hour >= 12 && hour < 17) greeting = 'Good afternoon';
            else if (hour >= 17) greeting = 'Good evening';

            document.getElementById('headerSub').textContent = greeting + ', Chaiti! ' + days[now.getDay()] + ', ' + dateStr + ' ‚Ä¢ ' + timeStr;
        }

        function calculateCountdowns() {
            var today = new Date();
            var marathon = new Date('2026-04-23');
            var gallery = new Date('2026-04-24');
            document.getElementById('marathonDays').textContent = Math.ceil((marathon - today) / (1000*60*60*24));
            document.getElementById('galleryDays').textContent = Math.ceil((gallery - today) / (1000*60*60*24));
        }

        // ========== VIEWS ==========
        function showView(viewName) {
            document.querySelectorAll('.view').forEach(function(v) { v.classList.remove('active'); });
            document.querySelectorAll('.nav-btn').forEach(function(b) { b.classList.remove('active'); });
            document.getElementById(viewName + 'View').classList.add('active');
            document.getElementById('btn' + viewName.charAt(0).toUpperCase() + viewName.slice(1)).classList.add('active');
        }

        // ========== TODAY VIEW ==========
        function renderTodayView() {
            var container = document.getElementById('todayTasks');
            var todayKey = getTodayKey();
            var todayTasks = tasks[todayKey] || [];

            todayTasks.sort(function(a, b) { return a.time.localeCompare(b.time); });

            var html = '';
            todayTasks.forEach(function(task) {
                var completedClass = task.completed ? 'completed' : '';
                html += '<div class="task-item cat-' + task.category + ' ' + completedClass + '" data-id="' + task.id + '">' +
                    '<div class="task-checkbox" data-id="' + task.id + '"><span class="task-checkbox-inner">‚úì</span></div>' +
                    '<div class="task-content" data-id="' + task.id + '">' +
                        '<div class="task-title">' + task.title + '</div>' +
                        '<div class="task-meta">' + formatTime(task.time) + ' ‚Ä¢ ' + task.duration + '</div>' +
                    '</div>' +
                    '<div class="task-actions">' +
                        '<button class="task-action-btn edit" data-id="' + task.id + '">‚úé</button>' +
                        '<button class="task-action-btn delete" data-id="' + task.id + '">√ó</button>' +
                    '</div>' +
                '</div>';
            });

            container.innerHTML = html;
            updateStats();
        }

        function updateStats() {
            var todayKey = getTodayKey();
            var todayTasks = tasks[todayKey] || [];
            var completed = todayTasks.filter(function(t) { return t.completed; }).length;
            var remaining = todayTasks.length - completed;

            document.getElementById('completedCount').textContent = completed;
            document.getElementById('remainingCount').textContent = remaining;
            document.getElementById('dayProgressBar').style.width = todayTasks.length ?
                (completed / todayTasks.length * 100) + '%' : '0%';
        }

        // ========== SUGGESTIONS ==========
        function renderSuggestions() {
            var container = document.getElementById('suggestionList');
            var dayName = getDayName();
            var templates = templateSchedule[dayName] || [];
            var todayKey = getTodayKey();
            var todayTasks = tasks[todayKey] || [];
            var addedIds = todayTasks.map(function(t) { return t.templateId; });

            var available = templates.filter(function(t) { return addedIds.indexOf(t.id) === -1; });

            if (available.length) {
                var html = '';
                available.forEach(function(t) {
                    html += '<div class="mini-suggestion cat-' + t.category + '" data-template="' + t.id + '">' +
                        '<span>' + t.title + '</span>' +
                        '<span style="color: #666;">' + t.duration + '</span>' +
                    '</div>';
                });
                container.innerHTML = html;
            } else {
                container.innerHTML = '<div style="color: #666; font-size: 0.8rem; padding: 10px;">All suggestions added!</div>';
            }
        }

        function addFromTemplate(templateId) {
            var dayName = getDayName();
            var templates = templateSchedule[dayName] || [];
            var template = templates.find(function(t) { return t.id === templateId; });
            if (!template) return;

            saveUndo();
            var todayKey = getTodayKey();
            if (!tasks[todayKey]) tasks[todayKey] = [];

            tasks[todayKey].push({
                id: generateId(),
                title: template.title,
                time: template.time,
                duration: template.duration,
                category: template.category,
                completed: false,
                templateId: templateId
            });

            saveData();
            renderTodayView();
            renderSuggestions();
        }

        function addAllTemplates() {
            var dayName = getDayName();
            var templates = templateSchedule[dayName] || [];
            var todayKey = getTodayKey();
            if (!tasks[todayKey]) tasks[todayKey] = [];

            saveUndo();

            templates.forEach(function(t) {
                var exists = tasks[todayKey].some(function(task) { return task.templateId === t.id; });
                if (!exists) {
                    tasks[todayKey].push({
                        id: generateId(),
                        title: t.title,
                        time: t.time,
                        duration: t.duration,
                        category: t.category,
                        completed: false,
                        templateId: t.id
                    });
                }
            });

            saveData();
            renderTodayView();
            renderSuggestions();
        }

        // ========== TASK ACTIONS ==========
        function toggleTask(taskId) {
            var todayKey = getTodayKey();
            var task = (tasks[todayKey] || []).find(function(t) { return t.id === taskId; });
            if (task) {
                saveUndo();
                task.completed = !task.completed;
                saveData();
                renderTodayView();
            }
        }

        function deleteTaskById(taskId) {
            saveUndo();
            var todayKey = getTodayKey();
            tasks[todayKey] = (tasks[todayKey] || []).filter(function(t) { return t.id !== taskId; });
            saveData();
            renderTodayView();
            renderSuggestions();
        }

        // ========== MODAL ==========
        function openAddModal() {
            editingTaskId = null;
            document.getElementById('modalTitle').textContent = 'Add New Task';
            document.getElementById('taskName').value = '';
            document.getElementById('taskCategory').value = 'other';
            document.getElementById('taskDuration').value = '1 hr';
            document.getElementById('taskTime').value = '09:00';
            document.getElementById('btnDelete').style.display = 'none';
            document.getElementById('taskModal').classList.add('active');
        }

        function openEditModal(taskId) {
            var todayKey = getTodayKey();
            var task = (tasks[todayKey] || []).find(function(t) { return t.id === taskId; });
            if (!task) return;

            editingTaskId = taskId;
            document.getElementById('modalTitle').textContent = 'Edit Task';
            document.getElementById('taskName').value = task.title;
            document.getElementById('taskCategory').value = task.category;
            document.getElementById('taskDuration').value = task.duration;
            document.getElementById('taskTime').value = task.time;
            document.getElementById('btnDelete').style.display = 'block';
            document.getElementById('taskModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('taskModal').classList.remove('active');
            editingTaskId = null;
        }

        function saveTask() {
            var name = document.getElementById('taskName').value.trim();
            if (!name) { alert('Please enter a task name'); return; }

            saveUndo();

            var taskData = {
                id: editingTaskId || generateId(),
                title: name,
                category: document.getElementById('taskCategory').value,
                duration: document.getElementById('taskDuration').value,
                time: document.getElementById('taskTime').value,
                completed: false
            };

            var todayKey = getTodayKey();
            if (!tasks[todayKey]) tasks[todayKey] = [];

            if (editingTaskId) {
                var idx = tasks[todayKey].findIndex(function(t) { return t.id === editingTaskId; });
                if (idx >= 0) tasks[todayKey][idx] = taskData;
            } else {
                tasks[todayKey].push(taskData);
            }

            saveData();
            closeModal();
            renderTodayView();
            renderWeekView();
            renderSuggestions();
        }

        // ========== WEEK VIEW ==========
        function renderWeekView() {
            var container = document.getElementById('weekGrid');
            var dayNames = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            var today = new Date();
            var todayName = getDayName();

            var monday = new Date(today);
            monday.setDate(today.getDate() - today.getDay() + 1);

            var html = '';
            dayNames.forEach(function(day, i) {
                var date = new Date(monday);
                date.setDate(monday.getDate() + i);
                var dateKey = date.toISOString().split('T')[0];
                var dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                var isToday = day === todayName;
                var dayTasks = tasks[dateKey] || [];

                html += '<div class="day-column ' + (isToday ? 'today' : '') + '">' +
                    '<div class="day-header">' +
                        '<div class="day-name">' + day + '</div>' +
                        '<div class="day-date">' + dateStr + '</div>' +
                    '</div>';

                dayTasks.forEach(function(t) {
                    html += '<div class="week-task cat-' + t.category + ' ' + (t.completed ? 'completed' : '') + '" data-date="' + dateKey + '" data-id="' + t.id + '">' + t.title + '</div>';
                });

                html += '</div>';
            });

            container.innerHTML = html;
        }

        function toggleWeekTask(dateKey, taskId) {
            var task = (tasks[dateKey] || []).find(function(t) { return t.id === taskId; });
            if (task) {
                saveUndo();
                task.completed = !task.completed;
                saveData();
                renderWeekView();
                if (dateKey === getTodayKey()) renderTodayView();
            }
        }

        // ========== FOOTER ACTIONS ==========
        function resetDay() {
            if (confirm('Reset all tasks for today?')) {
                saveUndo();
                tasks[getTodayKey()] = [];
                saveData();
                renderTodayView();
                renderSuggestions();
            }
        }

        function undoLast() {
            if (undoStack.length === 0) {
                alert('Nothing to undo');
                return;
            }
            tasks = JSON.parse(undoStack.pop());
            saveData();
            renderTodayView();
            renderWeekView();
            renderSuggestions();
        }

        function endDay() {
            var todayKey = getTodayKey();
            var todayTasks = tasks[todayKey] || [];
            var completed = todayTasks.filter(function(t) { return t.completed; }).length;

            if (completed === todayTasks.length && todayTasks.length > 0) {
                alert('üéâ Amazing! You completed all ' + completed + ' tasks!');
            } else {
                alert('Day ended! Completed: ' + completed + '/' + todayTasks.length);
            }
        }

        // ========== EVENT LISTENERS ==========
        document.getElementById('btnToday').addEventListener('click', function() { showView('today'); });
        document.getElementById('btnWeek').addEventListener('click', function() { showView('week'); });
        document.getElementById('btnGoals').addEventListener('click', function() { showView('goals'); });
        document.getElementById('btnAddTask').addEventListener('click', openAddModal);
        document.getElementById('btnFromTemplate').addEventListener('click', addAllTemplates);
        document.getElementById('btnCancel').addEventListener('click', closeModal);
        document.getElementById('btnSave').addEventListener('click', saveTask);
        document.getElementById('btnDelete').addEventListener('click', function() {
            if (editingTaskId && confirm('Delete this task?')) {
                deleteTaskById(editingTaskId);
                closeModal();
            }
        });
        document.getElementById('btnReset').addEventListener('click', resetDay);
        document.getElementById('btnUndo').addEventListener('click', undoLast);
        document.getElementById('btnEndDay').addEventListener('click', endDay);

        // Task list clicks
        document.getElementById('todayTasks').addEventListener('click', function(e) {
            var target = e.target;
            var taskId = target.dataset.id || target.closest('[data-id]')?.dataset.id;
            if (!taskId) return;

            if (target.classList.contains('task-checkbox') || target.classList.contains('task-checkbox-inner')) {
                toggleTask(taskId);
            } else if (target.classList.contains('edit') || target.closest('.task-content')) {
                openEditModal(taskId);
            } else if (target.classList.contains('delete')) {
                if (confirm('Delete this task?')) deleteTaskById(taskId);
            }
        });

        // Suggestion clicks
        document.getElementById('suggestionList').addEventListener('click', function(e) {
            var target = e.target.closest('[data-template]');
            if (target) addFromTemplate(target.dataset.template);
        });

        // Week view clicks
        document.getElementById('weekGrid').addEventListener('click', function(e) {
            var target = e.target.closest('.week-task');
            if (target) {
                toggleWeekTask(target.dataset.date, target.dataset.id);
            }
        });

        // Close modal on overlay click
        document.getElementById('taskModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });

        // ========== INIT ==========
        loadData();
        updateHeader();
        calculateCountdowns();
        renderTodayView();
        renderWeekView();
        renderSuggestions();
        setInterval(updateHeader, 60000);

        console.log('Dashboard loaded successfully!');
    </script>
</body>
</html>
